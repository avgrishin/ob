    public void Main()
    {
      var wc = new WebClient { Proxy = new WebProxy("proxy-cluster-bc.srv.nikoil.ru", 8080) { Credentials = CredentialCache.DefaultCredentials }, Encoding = Encoding.UTF8 };
      JavaScriptSerializer jss = new JavaScriptSerializer();
      jss.MaxJsonLength = Int32.MaxValue;
      string s;
      s = wc.UploadString("https://ws.cbonds.info/services/json/get_rating_agencies/?lang=rus&cache_all_revalidate=0&nocache_all=0", "{\"auth\":{\"login\":\"Test\",\"password\":\"\"},\"filters\":[],\"quantity\":{\"limit\":100,\"offset\":0},\"sorting\":[{\"field\":\"\",\"order\":\"asc\"}]}");
      var j1 = jss.Deserialize<RootObject<get_rating_agencies>>(s);
      using (StreamWriter sw = new StreamWriter("c:\\tmp\\ra.csv", false, Encoding.GetEncoding(1251)))
      {
        foreach (var ra in j1.items)
        {
          foreach (PropertyInfo prop in typeof(get_rating_agencies).GetProperties())
          {
            sw.Write(prop.GetValue(ra, null));
            sw.Write("\t");
          }
          sw.WriteLine();
        }
      }
      s = wc.UploadString("https://ws.cbonds.info/services/json/get_rating_forecasts/?lang=rus&cache_all_revalidate=0&nocache_all=0", "{\"auth\":{\"login\":\"Test\",\"password\":\"\"},\"filters\":[],\"quantity\":{\"limit\":100,\"offset\":0},\"sorting\":[{\"field\":\"\",\"order\":\"asc\"}]}");
      var j2 = jss.Deserialize<RootObject<get_rating_forecasts>>(s);
      s = wc.UploadString("https://ws.cbonds.info/services/json/get_rating_scales/?lang=rus&cache_all_revalidate=0&nocache_all=0", "{\"auth\":{\"login\":\"Test\",\"password\":\"\"},\"filters\":[],\"quantity\":{\"limit\":100,\"offset\":0},\"sorting\":[{\"field\":\"\",\"order\":\"asc\"}]}");
      var j3 = jss.Deserialize<RootObject<get_rating_scales>>(s);
      s = wc.UploadString("https://ws.cbonds.info/services/json/get_rating_scales/?lang=rus&cache_all_revalidate=0&nocache_all=0", "{\"auth\":{\"login\":\"Test\",\"password\":\"\"},\"filters\":[],\"quantity\":{\"limit\":100,\"offset\":0},\"sorting\":[{\"field\":\"\",\"order\":\"asc\"}]}");
      var j4 = jss.Deserialize<RootObject<get_rating_scales>>(s);
      //using (StreamWriter sw = new StreamWriter("c:\\tmp\\etf.csv", false, Encoding.GetEncoding(1251)))
      //{
      //  foreach (var row in j.aaData)
      //  {
      //    //jss.Deserialize()
      //    sw.WriteLine("{0}\t{1}\t{2}\t{3}", row[0], row[2], ((Dictionary<string, object>)row[3])["raw"], row[10]);
      //  }
      //}
      Dts.TaskResult = (int)ScriptResults.Success;
    }

    #region ScriptResults declaration
    /// <summary>
    /// This enum provides a convenient shorthand within the scope of this class for setting the
    /// result of the script.
    /// 
    /// This code was generated automatically.
    /// </summary>
    enum ScriptResults
    {
      Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
      Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
    };
    #endregion

  }

  public class get_emission_ratings
  {
    public string id { get; set; }
    public string agency_id { get; set; }
    public string agency_name_eng { get; set; }
    public object agency_name_ita { get; set; }
    public object agency_name_pol { get; set; }
    public string agency_name_rus { get; set; }
    public string date { get; set; }
    public string emission_emitent_country_id { get; set; }
    public string emission_emitent_country_region_id { get; set; }
    public string emission_emitent_id { get; set; }
    public string emission_emitent_name_eng { get; set; }
    public object emission_emitent_name_ita { get; set; }
    public object emission_emitent_name_pol { get; set; }
    public string emission_emitent_name_rus { get; set; }
    public string emission_id { get; set; }
    public string emission_isin_code { get; set; }
    public string emission_number_eng { get; set; }
    public object emission_number_ita { get; set; }
    public object emission_number_pol { get; set; }
    public string emission_number_rus { get; set; }
    public string emission_state_reg_number { get; set; }
    public string forecast_id { get; set; }
    public string forecast_name_eng { get; set; }
    public string forecast_name_ita { get; set; }
    public string forecast_name_pol { get; set; }
    public string forecast_name_rus { get; set; }
    public string scale_id { get; set; }
    public string scale_name_eng { get; set; }
    public object scale_name_ita { get; set; }
    public object scale_name_pol { get; set; }
    public string scale_name_rus { get; set; }
    public string scale_point_id { get; set; }
    public string scale_point_name { get; set; }
    public DateTime updating_date { get; set; }
  }

  public class get_emitent_ratings
  {
    public string id { get; set; }
    public string agency_id { get; set; }
    public string agency_name_eng { get; set; }
    public object agency_name_ita { get; set; }
    public object agency_name_pol { get; set; }
    public string agency_name_rus { get; set; }
    public string date { get; set; }
    public string emission_emitent_name_eng { get; set; }
    public object emission_emitent_name_ita { get; set; }
    public object emission_emitent_name_pol { get; set; }
    public string emission_emitent_name_rus { get; set; }
    public string emitent_country_id { get; set; }
    public string emitent_country_region_id { get; set; }
    public string emitent_id { get; set; }
    public string emitent_inn { get; set; }
    public string emitent_inn_ua { get; set; }
    public string emitent_lei { get; set; }
    public string forecast_id { get; set; }
    public string forecast_name_eng { get; set; }
    public string forecast_name_ita { get; set; }
    public string forecast_name_pol { get; set; }
    public string forecast_name_rus { get; set; }
    public string scale_id { get; set; }
    public string scale_name_eng { get; set; }
    public object scale_name_ita { get; set; }
    public object scale_name_pol { get; set; }
    public string scale_name_rus { get; set; }
    public string scale_point_id { get; set; }
    public string scale_point_name { get; set; }
    public DateTime updating_date { get; set; }
  }

  public class get_rating_forecasts
  {
    public string id { get; set; }
    public string name_eng { get; set; }
    public string name_rus { get; set; }
    public string statuses_id { get; set; }
    public DateTime statuses_update_time { get; set; }
  }

  public class get_rating_agencies
  {
    public string id { get; set; }
    public string name_eng { get; set; }
    public object name_ita { get; set; }
    public string name_pol { get; set; }
    public string name_rus { get; set; }
    public DateTime rating_agency_creation_date { get; set; }
  }

  public class get_rating_scales
  {
    public string id { get; set; }
    public string name_eng { get; set; }
    public string name_rus { get; set; }
    public string rating_agency_id { get; set; }
    public DateTime rating_scales_update_time { get; set; }
    public string rating_scale_type_id { get; set; }
    public string rating_scale_type_name_eng { get; set; }
    public string rating_scale_type_name_rus { get; set; }
  }

  public class get_rating_scale_points
  {
    public string id { get; set; }
    public string agency_id { get; set; }
    public string agency_name_eng { get; set; }
    public string agency_name_rus { get; set; }
    public string description_eng { get; set; }
    public string description_rus { get; set; }
    public string name { get; set; }
    public DateTime rating_scale_point_update_time { get; set; }
    public string scale_id { get; set; }
    public string scale_name_eng { get; set; }
    public string scale_name_rus { get; set; }
    public string scale_type_id { get; set; }
    public string scale_type_name_eng { get; set; }
    public string scale_type_name_rus { get; set; }
  }

  public class Meta
  {
    public double cms_full_gen_time { get; set; }
    public int user_id { get; set; }
    public string lang { get; set; }
    public int strict_mode { get; set; }
    public int performLogging { get; set; }
  }

  public class RootObject<T>
  {
    public int count { get; set; }
    public int total { get; set; }
    public int limit { get; set; }
    public int offset { get; set; }
    public double exec_time { get; set; }
    public List<T> items { get; set; }
    public Meta meta { get; set; }
  }
